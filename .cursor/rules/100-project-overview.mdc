# 프로젝트 개요 및 핵심 기획 규칙

## 프로젝트 개요

**매칭미? (Matching Me?)**는 룸메이트 매칭 플랫폼으로, Next.js 15 App Router와 Supabase를 기반으로 구축됩니다.

## 프로젝트 전략 및 Phase 구분

### Phase 1 (MVP) - 핵심 가치 구현
**목표**: "내가 등록하고, 나랑 맞는 사람의 AI 요약을 확인한다."

**구현 범위**:
- ✅ Google 소셜 로그인을 통한 본인 인증 및 가입
- ✅ 3단계 온보딩 프로필 등록
- ✅ 소속관(동작/은평) 기반 데이터 격리
- ✅ AI 매칭 요약 카드 피드
- ✅ 프로필 상세 조회 및 연락처 즉시 공개

### Phase 2 (고도화) - 운영 효율 및 신뢰도 강화
**목표**: "조회 권한 관리 및 매칭 완료 상태 관리."

**추가 기능**:
- 🔲 조회권 시스템 (일일 3회 제한)
- 🔲 매칭 완료 상태 관리 (`is_active` 플래그)
- 🔲 상세 필터링 (잠버릇, 청결도 등 복합 조건)
- 🔲 찜하기 기능
- 🔲 이미지 업로드 (Supabase Storage)
- 🔲 스켈레톤 UI 로딩
- 🔲 개인정보 마스킹 (조회권 사용 전)

## 핵심 기능 명세

### 1. 인증 (Auth)
- **방식**: Google Social Login (OAuth 2.0)
- **요구사항**: Supabase Auth와 통합
- **플로우**: 로그인 → 온보딩 체크 → 프로필 미완료 시 온보딩으로 리다이렉트

### 2. 온보딩 (프로필 등록)
**3단계 구조**:
- **Step 1**: 기본 정보 (이름, 성별, 소속관, 계열, 학년)
- **Step 2**: 연락처 (전화번호, 카카오톡 ID)
- **Step 3**: 라이프 패턴 (수면시간, 잠버릇, 청결도, 흡연 여부, 소음민감도, 자기소개)

**데이터 저장**:
- `profiles` 테이블에 프로필 정보 저장
- `matching_posts` 테이블에 매칭 게시글 생성

### 3. 매칭 피드 (Main Feed)
**데이터 격리 원칙**:
- 접속자의 소속관(동작/은평)에 맞는 게시글만 자동 노출
- RLS 정책을 통한 서버 사이드 필터링 필수

**AI 긍정 요약**:
- 상대방의 패턴과 내 패턴을 비교하여 "우리는 이런 점이 잘 맞아요" 문구 생성
- 각 프로필 카드에 AI 요약 텍스트 노출
- OpenAI API 활용

**탭 구조**:
- **전체 매칭**: 소속관 기반 모든 활성 프로필
- **AI 추천**: `matchScore >= 80`인 프로필만 표시

### 4. 프로필 상세 및 조회
- 상대방의 상세한 라이프 패턴 확인
- 연락처 확인: 텍스트 기반 카카오톡 ID 또는 전화번호 노출
- Phase 1: 즉시 공개
- Phase 2: 조회권 사용 후 공개 (일일 3회 제한)

## 데이터 모델링 핵심 원칙

### 테이블 구조
- `users`: Google OAuth 인증 정보
- `profiles`: 온보딩에서 수집한 개인정보
- `matching_posts`: 매칭용 게시글 및 AI 요약 저장
- `view_logs` (Phase 2): 연락처 조회 기록
- `bookmarks` (Phase 2): 찜한 프로필 목록
- `daily_limits` (Phase 2): 일일 조회 제한 추적

### 데이터 격리 (Dormitory-based Filtering)
- `matching_posts.dormitory` 필드로 동작관/은평관 분리
- 사용자는 자신의 소속관 데이터만 조회 가능
- RLS 정책으로 강제 적용

## 개발 시 준수 사항

1. **Phase 구분 명확히**: Phase 1 기능과 Phase 2 기능을 명확히 구분하여 구현
2. **데이터 격리 필수**: 모든 프로필 조회 쿼리는 소속관 기반 필터링 필수
3. **AI 요약 생성**: 각 프로필 카드에 대해 사용자 패턴 비교 후 긍정적 요약 생성
4. **보안 우선**: 개인정보는 RLS 정책과 조회권 시스템으로 보호
5. **확장성 고려**: Phase 2 기능 추가를 고려한 구조 설계
